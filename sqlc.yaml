version: "2"
sql:
  - engine: postgresql
    schema:
      - internal/migrate/migrations/0001_init.up.sql
      - internal/migrate/migrations/0002_indexes.up.sql
      - internal/migrate/migrations/0003_popularity_idx.up.sql
      - internal/migrate/migrations/0004_votes_unique_movie_voter.up.sql
      - internal/migrate/migrations/0005_add_external_urls.up.sql
    queries:
      - internal/store/queries
    gen:
      go:
        package: store
        out: internal/store
        sql_package: pgx/v5
        emit_json_tags: true
        emit_empty_slices: true
        emit_exported_queries: true
        overrides:
          - db_type: "uuid"
            go_type:
              import: "github.com/jackc/pgx/v5/pgtype"
              type: "UUID"
          - db_type: "jsonb"
            go_type:
              import: "encoding/json"
              type: "RawMessage"
          - db_type: "vote_category"
            go_type: "string"
